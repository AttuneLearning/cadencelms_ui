{
  "team": {
    "name": "Person Data Migration Team",
    "version": "1.0.0",
    "description": "Specialized team for migrating UI to Person Data v2.0 architecture (ISS-001)",
    "activeProject": "Person Data v2.0 Migration - Breaking Changes",
    "implementationPlan": "impl_plans/person_change_implementation_plan.md",
    "apiContracts": [
      "/home/adam/github/cadencelms_api/contracts/api/person.contract.ts",
      "/home/adam/github/cadencelms_api/contracts/api/demographics.contract.ts",
      "/home/adam/github/cadencelms_api/contracts/api/users.contract.ts"
    ]
  },
  "workflow": {
    "developmentApproach": "Test-Driven Development (TDD) - Comprehensive coverage",
    "phaseStructure": "5 sequential phases with parallel work streams",
    "phases": [
      "Phase 1: Foundation & Setup (types, helpers, API layer)",
      "Phase 2: Auth Store & Context Updates",
      "Phase 3: Core UI Components (header, sidebar, user menu)",
      "Phase 4: Profile Pages (ISS-001 unblocked)",
      "Phase 5: Profile-Related Features (staff directory, settings)"
    ],
    "commitStrategy": "Commit after each phase completion",
    "testCoverage": "80%+ comprehensive coverage",
    "autoSave": "Implement 2-minute debounced auto-save for profile forms",
    "avatarHandling": "URL input only (no file upload yet)",
    "demographicsConsent": "Prominent but optional consent checkboxes"
  },
  "agents": [
    {
      "id": "foundation-builder",
      "role": "Foundation & Infrastructure Specialist",
      "phase": "Phase 1",
      "description": "Creates TypeScript types, helper functions, and API service layer for person data",
      "responsibilities": [
        "Create TypeScript types matching API contracts exactly",
        "Write comprehensive type definitions for IPerson, IPersonExtended, IDemographics",
        "Implement helper functions with full test coverage",
        "Create API service layer with proper error handling",
        "Update test mocks and fixtures",
        "Follow TDD: Write tests FIRST, then implementation",
        "Achieve 80%+ test coverage for all utilities",
        "Validate types match API contracts exactly"
      ],
      "deliverables": [
        "src/shared/types/person.ts - IPerson, IPersonExtended, IDemographics interfaces",
        "src/shared/types/enums.ts - All enum types from contracts",
        "src/shared/lib/person-helpers.ts - Utility functions with tests",
        "src/shared/api/personApi.ts - Person API client",
        "src/shared/api/demographicsApi.ts - Demographics API client",
        "src/test/fixtures/person.fixtures.ts - Mock data",
        "src/shared/types/person.ts.__tests__/ - Type validation tests",
        "src/shared/lib/__tests__/person-helpers.test.ts - Helper tests",
        "Updated src/shared/api/userApi.ts - Handle person object",
        "Updated src/test/mocks/server.ts - New endpoints"
      ],
      "testingRequirements": {
        "tddCycle": "RED (test first) → GREEN (minimal code) → REFACTOR",
        "coverage": "80%+ for all helper functions",
        "edgeCases": "Test null, undefined, empty arrays",
        "typeValidation": "Ensure types match contracts exactly"
      },
      "canRunParallel": false,
      "dependencies": [],
      "blocksPhases": [2, 3, 4, 5]
    },
    {
      "id": "state-coordinator",
      "role": "State Management & Auth Specialist",
      "phase": "Phase 2",
      "description": "Updates authentication store and hooks to use new person structure",
      "responsibilities": [
        "Update authStore to handle person object",
        "Migrate all firstName/lastName references to person.firstName/person.lastName",
        "Update auth hooks to expose person data",
        "Create new hooks: usePersonData(), useDisplayName()",
        "Update login/refresh flows to map person data",
        "Write comprehensive tests for state management",
        "Follow TDD for all store updates",
        "Ensure backward compatibility during transition",
        "Achieve 80%+ coverage for auth store changes"
      ],
      "deliverables": [
        "Updated src/features/auth/model/authStore.ts",
        "Updated src/features/auth/api/authApi.ts",
        "Updated src/features/auth/hooks/useCurrentUser.ts",
        "src/features/auth/hooks/usePersonData.ts - New hook",
        "src/features/auth/hooks/useDisplayName.ts - New hook",
        "src/features/auth/model/__tests__/authStore.test.ts - Updated tests",
        "src/features/auth/hooks/__tests__/usePersonData.test.ts",
        "src/features/auth/hooks/__tests__/useDisplayName.test.ts"
      ],
      "testingRequirements": {
        "storeTests": "Test state updates, selectors, computed values",
        "hookTests": "Test custom hooks with React Testing Library",
        "integrationTests": "Test login flow with new person structure",
        "regressionTests": "Ensure existing auth tests still pass"
      },
      "canRunParallel": false,
      "dependencies": ["foundation-builder"],
      "blocksPhases": [3, 4, 5]
    },
    {
      "id": "ui-builder",
      "role": "Core UI Components Specialist",
      "phase": "Phase 3",
      "description": "Updates foundational UI components (Header, Sidebar, User Menu) to display person data",
      "responsibilities": [
        "Update Header to use getDisplayName() for user name",
        "Update Sidebar user info section",
        "Update UserMenu to show person data",
        "Create UserAvatar component with fallback to initials",
        "Create UserCard component with person data display",
        "Add pronouns display support",
        "Write component tests for all updates",
        "Follow TDD for new components",
        "Ensure accessibility compliance",
        "Test responsive design",
        "Achieve 80%+ coverage"
      ],
      "deliverables": [
        "Updated src/widgets/header/Header.tsx",
        "Updated src/widgets/sidebar/Sidebar.tsx",
        "Updated src/widgets/header/UserMenu.tsx",
        "src/shared/ui/UserAvatar.tsx - New component",
        "src/shared/ui/UserCard.tsx - New component",
        "src/widgets/header/__tests__/Header.test.tsx - Updated tests",
        "src/widgets/sidebar/__tests__/Sidebar.test.tsx - Updated tests",
        "src/shared/ui/__tests__/UserAvatar.test.tsx",
        "src/shared/ui/__tests__/UserCard.test.tsx"
      ],
      "testingRequirements": {
        "componentTests": "Test rendering, props, interactions",
        "accessibilityTests": "ARIA labels, keyboard navigation",
        "responsiveTests": "Test at multiple breakpoints",
        "visualTests": "Verify correct data display"
      },
      "canRunParallel": true,
      "dependencies": ["foundation-builder", "state-coordinator"],
      "blocksPhases": []
    },
    {
      "id": "page-builder",
      "role": "Profile Pages Implementation Lead",
      "phase": "Phase 4",
      "description": "Implements profile management pages with forms and auto-save functionality",
      "responsibilities": [
        "Create ProfilePage with tabbed sections",
        "Implement BasicInfoForm with auto-save (2-minute debounce)",
        "Implement ContactInfoForm for emails/phones/addresses arrays",
        "Implement PreferencesForm for timezone, language, notifications",
        "Implement ConsentForm for legal consent tracking",
        "Create ExtendedProfilePage with role-specific rendering",
        "Implement EmergencyContactsForm (learners)",
        "Implement ProfessionalInfoForm (staff)",
        "Create DemographicsPage with prominent consent UI",
        "Implement DemographicsForm with all optional fields",
        "Add form validation and error handling",
        "Write comprehensive form tests",
        "Test auto-save functionality",
        "Test array management (add/edit/remove)",
        "Achieve 80%+ coverage"
      ],
      "deliverables": [
        "src/pages/profile/ProfilePage.tsx",
        "src/pages/profile/ExtendedProfilePage.tsx",
        "src/pages/profile/DemographicsPage.tsx",
        "src/features/profile/ui/BasicInfoForm.tsx",
        "src/features/profile/ui/ContactInfoForm.tsx",
        "src/features/profile/ui/PreferencesForm.tsx",
        "src/features/profile/ui/ConsentForm.tsx",
        "src/features/profile/ui/EmergencyContactsForm.tsx",
        "src/features/profile/ui/HousingInfoForm.tsx",
        "src/features/profile/ui/AccommodationsForm.tsx",
        "src/features/profile/ui/ProfessionalInfoForm.tsx",
        "src/features/profile/ui/CredentialsForm.tsx",
        "src/features/profile/ui/OfficeHoursForm.tsx",
        "src/features/profile/ui/DemographicsForm.tsx",
        "src/features/profile/hooks/useAutoSave.ts - Auto-save hook",
        "Updated src/app/router.tsx - Add profile routes",
        "Comprehensive test suite for all forms"
      ],
      "testingRequirements": {
        "formTests": "Test validation, submission, error handling",
        "autoSaveTests": "Test debounce, save triggers, error recovery",
        "arrayTests": "Test add/edit/remove for emails/phones/addresses",
        "roleTests": "Test role-specific rendering (staff vs learner)",
        "consentTests": "Test prominent consent UI, optional submission"
      },
      "canRunParallel": true,
      "dependencies": ["foundation-builder", "state-coordinator"],
      "blocksPhases": []
    },
    {
      "id": "feature-integrator",
      "role": "Feature Integration & Enhancement Specialist",
      "phase": "Phase 5",
      "description": "Updates existing features to use new person data structure",
      "responsibilities": [
        "Update StaffDirectoryPage to display person data",
        "Add pronouns and preferred names to staff cards",
        "Update student record views to use person object",
        "Update search components to search preferred names",
        "Create NotificationSettingsPage for communication preferences",
        "Update any other features using person data",
        "Write tests for all updated features",
        "Ensure no data inconsistencies",
        "Achieve 80%+ coverage for changes"
      ],
      "deliverables": [
        "Updated src/pages/staff/directory/StaffDirectoryPage.tsx",
        "Updated src/features/staff/ui/StaffCard.tsx (if exists)",
        "Updated src/pages/staff/students/StudentListPage.tsx (if exists)",
        "Updated search and filter components",
        "src/pages/settings/NotificationSettingsPage.tsx",
        "Test suite for all feature updates"
      ],
      "testingRequirements": {
        "featureTests": "Test updated features work correctly",
        "integrationTests": "Test data flows through features",
        "searchTests": "Test search with preferred names",
        "settingsTests": "Test notification settings UI"
      },
      "canRunParallel": true,
      "dependencies": ["foundation-builder", "state-coordinator"],
      "blocksPhases": []
    }
  ],
  "parallelizationConfig": {
    "maxConcurrentAgents": 3,
    "parallelStrategy": {
      "phase1": "foundation-builder works solo (blocks all others)",
      "phase2": "state-coordinator works solo (blocks UI work)",
      "phase3-5": "ui-builder, page-builder, feature-integrator can work in parallel"
    },
    "executionOrder": [
      "Phase 1: foundation-builder (sequential, blocks all)",
      "Phase 2: state-coordinator (sequential, blocks UI)",
      "Phase 3-5: ui-builder + page-builder + feature-integrator (parallel)"
    ]
  },
  "sharedContext": {
    "migrationGoals": {
      "primary": "Migrate from flat person fields to nested person object",
      "secondary": "Enable preferred names, pronouns, multiple contacts",
      "tertiary": "Support demographics collection for compliance"
    },
    "breakingChanges": {
      "dataStructure": "data.firstName → data.person.firstName",
      "phoneField": "data.phone → data.person.phones[0].number (string → array)",
      "avatarField": "data.profileImage → data.person.avatar (renamed)",
      "newFields": "preferredFirstName, preferredLastName, pronouns, emails[], addresses[]"
    },
    "apiEndpoints": {
      "basic": "GET/PUT /api/v2/users/me/person",
      "extended": "GET/PUT /api/v2/users/me/person/extended",
      "demographics": "GET/PUT /api/v2/users/me/demographics"
    },
    "helperFunctions": {
      "getPrimaryEmail": "Find primary email or return first",
      "getPrimaryPhone": "Find primary phone or return first",
      "getPrimaryAddress": "Find primary address or return first",
      "getDisplayName": "Use preferred name if set, else legal name",
      "getFullLegalName": "Full legal name with middle name and suffix",
      "formatPhoneNumber": "Format phone for display"
    },
    "architecturePatterns": {
      "featureSlicedDesign": "Follow FSD layers: app > pages > widgets > features > entities > shared",
      "stateManagement": "React Query for server state, Zustand for client state",
      "autoSave": "2-minute debounce with useAutoSave hook",
      "validation": "Client-side + server validation with clear error messages",
      "arrays": "Support add/edit/remove for emails, phones, addresses"
    },
    "testingStandards": {
      "tdd": "Write tests FIRST, then implementation (RED-GREEN-REFACTOR)",
      "coverage": "80%+ comprehensive coverage required",
      "unitTests": "Test helpers, hooks, utilities",
      "componentTests": "Test UI components with React Testing Library",
      "integrationTests": "Test data flows, auth updates, form submissions",
      "edgeCases": "Test null, undefined, empty arrays, missing optional fields"
    },
    "uiRequirements": {
      "avatarUpload": "URL input only (no file upload)",
      "autoSave": "2-minute debounce on all profile forms",
      "demographicsConsent": "Prominent but optional consent checkboxes",
      "preferredNames": "Display preferred names throughout app",
      "pronouns": "Show pronouns in appropriate contexts",
      "arrays": "Manage multiple emails/phones/addresses with primary flag"
    }
  },
  "workflowRules": {
    "phaseCommits": "Commit after each phase completion",
    "branchNaming": "feat/person-data-v2-migration",
    "commitFormat": "feat(person-v2): <phase description>",
    "tddRequired": true,
    "testFirst": "Write failing tests before implementation (RED phase)",
    "minTestCoverage": 80,
    "regressionTestsRequired": "All existing tests must pass",
    "phaseValidation": "Each phase must be complete and tested before next phase"
  },
  "communicationChannels": {
    "implementationPlan": {
      "path": "impl_plans/person_change_implementation_plan.md",
      "purpose": "Master plan for migration",
      "format": "8-phase detailed plan",
      "updateFrequency": "Update completion status after each phase"
    },
    "apiContracts": {
      "path": "/home/adam/github/cadencelms_api/contracts/api/",
      "files": ["person.contract.ts", "demographics.contract.ts", "users.contract.ts"],
      "purpose": "Source of truth for API structure"
    },
    "breakingChangesDoc": {
      "path": "/home/adam/github/cadencelms_api/agent_coms/messages/2026-01-12_BREAKING_CHANGES_IPerson_v2.md",
      "purpose": "API team's breaking changes notification",
      "contains": "Migration guide, examples, new features"
    }
  },
  "tooling": {
    "development": {
      "vite": "v7.3.1 - Development server with HMR",
      "typescript": "Strict mode enabled",
      "react": "18+ with hooks",
      "reactRouter": "v7 with future flags enabled"
    },
    "stateManagement": {
      "zustand": "Client state (auth, navigation)",
      "reactQuery": "Server state (API data, caching)",
      "customHooks": "useAutoSave for 2-minute debounced saves"
    },
    "uiComponents": {
      "shadcn": "Accessible component primitives",
      "tailwind": "Utility-first CSS framework",
      "lucideReact": "Icon library"
    },
    "testing": {
      "vitest": "v4.0.17 - Unit testing framework",
      "reactTestingLibrary": "Component testing",
      "msw": "v2.12.7 - API mocking for tests",
      "coverage": "80%+ required for all new code"
    }
  }
}
